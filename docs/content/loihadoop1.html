<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S·ªï Tay L·ªánh & Kh·∫Øc Ph·ª•c L·ªói Hadoop 3.3.6</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; padding: 20px; }
        h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { color: #2980b9; margin-top: 30px; }
        h3 { color: #e74c3c; margin-top: 25px; border-left: 4px solid #e74c3c; padding-left: 10px; }
        h4 { color: #2980b9; margin-top: 15px; }
        hr { border: 0; border-top: 1px solid #ecf0f1; margin: 20px 0; }
        p { margin-bottom: 15px; }
        /* Style cho b·∫£ng l·ªánh (gi·ªëng trang t√≠nh) */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; table-layout: fixed; }
        th, td { border: 1px solid #bdc3c7; padding: 8px; text-align: left; word-wrap: break-word; font-size: 14px; }
        th { background-color: #3498db; color: white; font-weight: bold; }
        tr:nth-child(even) { background-color: #f8f9fa; }
        .command-group { background-color: #2980b9 !important; color: white !important; font-weight: bold; text-align: center; }
        
        /* Style cho kh·ªëi code */
        code { background-color: #eee; padding: 2px 4px; border-radius: 3px; font-family: monospace; font-size: 13px; }
        pre { background-color: #2c3e50; color: #ecf0f1; padding: 10px; border-radius: 5px; overflow-x: auto; }
        pre code { background-color: transparent; color: inherit; padding: 0; border-radius: 0; font-size: 14px; }
    </style>
</head>
<body>

<h1>S·ªï Tay L·ªánh & Kh·∫Øc Ph·ª•c L·ªói Hadoop 3.3.6 (Single Node)</h1>
<p>B·∫£ng t·ªïng h·ª£p c√°c l·ªánh thao t√°c c∆° b·∫£n v√† h∆∞·ªõng d·∫´n kh·∫Øc ph·ª•c c√°c l·ªói th∆∞·ªùng g·∫∑p trong qu√° tr√¨nh v·∫≠n h√†nh Hadoop tr√™n **Ubuntu/WSL2**.</p>

<hr>

<h2>I. B·∫£ng T·ªïng H·ª£p L·ªánh Thao T√°c C∆° B·∫£n</h2>

<table>
    <thead>
        <tr>
            <th>C√∫ ph√°p L·ªánh</th>
            <th>√ù nghƒ©a (M·ª•c ƒë√≠ch)</th>
        </tr>
    </thead>
    <tbody>
        <tr class="command-group">
            <td colspan="2">L·ªánh ƒêi·ªÅu khi·ªÉn C·ª•m</td>
        </tr>
        <tr>
            <td><code>stop-all.sh</code></td>
            <td>D·ª´ng ho·∫°t ƒë·ªông c·ªßa t·∫•t c·∫£ c√°c d·ªãch v·ª• Hadoop (HDFS v√† YARN).</td>
        </tr>
        <tr>
            <td><code>start-all.sh</code></td>
            <td>Ch·∫°y to√†n b·ªô h·ªá th·ªëng c·ª•m Hadoop (NN, DN, RM, NM).</td>
        </tr>
        <tr>
            <td><code>jps</code></td>
            <td>Ki·ªÉm tra c√°c ti·∫øn tr√¨nh Java ƒëang ch·∫°y (X√°c nh·∫≠n 5 Daemon c·ªßa Hadoop).</td>
        </tr>
        <tr class="command-group">
            <td colspan="2">L·ªánh Ch·∫°y Job MapReduce & HDFS</td>
        </tr>
        <tr>
            <td><code>hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.6.jar wordcount /user/$(whoami)/input /user/$(whoami)/output_4</code></td>
            <td>Ch·∫°y Job WordCount (ƒë·∫øm t·ª´) tr√™n d·ªØ li·ªáu ƒë·∫ßu v√†o, ghi k·∫øt qu·∫£ ra th∆∞ m·ª•c <code>output_4</code>.</td>
        </tr>
        <tr>
            <td><code>hdfs dfs -rm -r /user/$(whoami)/output_4</code></td>
            <td>X√≥a th∆∞ m·ª•c output tr√™n HDFS (B·∫Øt bu·ªôc tr∆∞·ªõc khi ch·∫°y l·∫°i Job).</td>
        </tr>
        <tr>
            <td><code>hdfs dfs -cat /user/$(whoami)/output_4/part-r-00000</code></td>
            <td>Xem n·ªôi dung c·ªßa file k·∫øt qu·∫£ Job WordCount tr√™n HDFS.</td>
        </tr>
        <tr class="command-group">
            <td colspan="2">L·ªánh Thao T√°c Tr√¨nh So·∫°n Th·∫£o Nano</td>
        </tr>
        <tr>
            <td><code>Ctrl + O</code> / <code>+ Enter</code></td>
            <td>L∆∞u c√°c thay ƒë·ªïi ƒë√£ th·ª±c hi·ªán trong tr√¨nh so·∫°n th·∫£o <code>nano</code>.</td>
        </tr>
        <tr>
            <td><code>Ctrl + X</code></td>
            <td>Tho√°t kh·ªèi tr√¨nh so·∫°n th·∫£o <code>nano</code>.</td>
        </tr>
    </tbody>
</table>

<hr>

<h2>II. C√°c L·ªói Th∆∞·ªùng G·∫∑p v√† C√°ch Kh·∫Øc Ph·ª•c</h2>

    <h3>1. L·ªói InvalidAuxServiceException (Kh√¥ng t√¨m th·∫•y d·ªãch v·ª• Shuffle)</h3>
    <p><strong>Tri·ªáu ch·ª©ng:</strong> Job th·∫•t b·∫°i v·ªõi l·ªói <code>org.apache.hadoop.yarn.exceptions.InvalidAuxServiceException: The auxService:mapreduce_shuffle does not exist</code>.</p>
    <p><strong>Ch·∫©n ƒëo√°n:</strong> L·ªói tr·ª±c ti·∫øp do **NodeManager** kh√¥ng t√¨m th·∫•y khai b√°o d·ªãch v·ª• <code>mapreduce_shuffle</code> trong file <code>yarn-site.xml</code>.</p>
    
    <h4>üõ†Ô∏è Gi·∫£i ph√°p v√† C√°c b∆∞·ªõc kh·∫Øc ph·ª•c:</h4>
    <ol>
        <li>**D·ª´ng d·ªãch v·ª•:** Ch·∫°y <code>stop-all.sh</code>.</li>
        <li>**Ki·ªÉm tra/S·ª≠a file <code>yarn-site.xml</code>:** D√πng l·ªánh <code>nano yarn-site.xml</code> ƒë·ªÉ ƒë·∫£m b·∫£o c·∫•u h√¨nh sau ƒë√£ ƒë∆∞·ª£c th√™m/s·ª≠a ƒë√∫ng: 
<pre><code>&lt;property&gt;
    &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
    &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
&lt;/property&gt;</code></pre>
        </li>
        <li>**Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:** Ch·∫°y <code>start-all.sh</code>.</li>
        <li>**Ch·∫°y l·∫°i Job:** Ch·∫°y l·∫°i Job v·ªõi t√™n output m·ªõi (ho·∫∑c x√≥a output c≈©).</li>
    </ol>

    <h4>‚úÖ K·∫øt qu·∫£ (Log Job WordCount th√†nh c√¥ng):</h4>
    <p>Khi Job ch·∫°y th√†nh c√¥ng, h·ªá th·ªëng s·∫Ω tr·∫£ ra c√°c log <code>INFO</code> sau:</p>
    <ul>
        <li><code>client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager...</code>: K·∫øt n·ªëi ƒë·∫øn ResourceManager th√†nh c√¥ng.</li>
        <li><code>mapreduce.Job: The url to track the job: http://LAPTOP-408D47IP.localdomain:8088/...</code>: Cung c·∫•p URL theo d√µi Job tr√™n Web YARN.</li>
        <li><code>mapreduce.Job: map 100% reduce 100%</code>: Giai ƒëo·∫°n Map v√† Reduce ho√†n t·∫•t.</li>
        <li><code>mapreduce.Job: Job job_1763916885733_0001 completed successfully</code>: **Job ƒë√£ ho√†n th√†nh th√†nh c√¥ng!**</li>
    </ul>

    <h3>2. L·ªói Kh√¥ng truy c·∫≠p ƒë∆∞·ª£c giao di·ªán YARN UI (localhost:8088)</h3>
    <p><strong>Tri·ªáu ch·ª©ng:</strong> C√°c ti·∫øn tr√¨nh Hadoop ƒëang ch·∫°y (<code>jps</code> ƒë·ªß 5 ti·∫øn tr√¨nh) nh∆∞ng kh√¥ng th·ªÉ truy c·∫≠p ƒë∆∞·ª£c ƒë·ªãa ch·ªâ <code>http://localhost:8088</code>.</p>
    <p><strong>Ch·∫©n ƒëo√°n:</strong> **ResourceManager** ƒëang ch·∫°y nh∆∞ng c·ªïng 8088 ch∆∞a ƒë∆∞·ª£c li√™n k·∫øt (bind) t·ªõi ƒë·ªãa ch·ªâ <code>0.0.0.0</code> ƒë·ªÉ Windows/WSL2 c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c.</p>
    
    <h4>üõ†Ô∏è Gi·∫£i ph√°p v√† C√°c b∆∞·ªõc kh·∫Øc ph·ª•c:</h4>
    <ol>
        <li>**Ki·ªÉm tra ti·∫øn tr√¨nh:** Ch·∫°y <code>jps</code> (ph·∫£i th·∫•y ƒë·ªß 5 ti·∫øn tr√¨nh).</li>
        <li>**S·ª≠a c·∫•u h√¨nh li√™n k·∫øt Web:** M·ªü file <code>yarn-site.xml</code> v√† th√™m kh·ªëi c·∫•u h√¨nh sau (ho·∫∑c thay ƒë·ªïi gi√° tr·ªã <code>&lt;value&gt;</code>) v√†o gi·ªØa th·∫ª <code>&lt;configuration&gt;</code>: 
<pre><code>&lt;property&gt;
    &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;
    &lt;value&gt;0.0.0.0:8088&lt;/value&gt;
&lt;/property&gt;</code></pre>
        </li>
        <li>**Kh·ªüi ƒë·ªông l·∫°i b·∫Øt bu·ªôc:** Ch·∫°y <code>stop-all.sh</code> v√† sau ƒë√≥ <code>start-all.sh</code> ƒë·ªÉ √°p d·ª•ng c·∫•u h√¨nh m·ªõi.</li>
        <li>**Ki·ªÉm tra l·∫°i:** Truy c·∫≠p <code>http://localhost:8088</code>.</li>
    </ol>

<hr>

<h2>III. H∆∞·ªõng D·∫´n Kh·ªüi ƒê·ªông L·∫°i Hadoop Sau Khi T·∫Øt M√°y</h2>
<p>ƒê·ªÉ ti·∫øt ki·ªám t√†i nguy√™n v√† ƒë·∫£m b·∫£o h·ªá th·ªëng ·ªïn ƒë·ªãnh, anh c·∫ßn tu√¢n th·ªß quy tr√¨nh kh·ªüi ƒë·ªông l·∫°i Hadoop/WSL2 sau khi m√°y t√≠nh ƒë√£ t·∫Øt:</p>

<ol>
    <li>**Kh·ªüi ƒë·ªông M√¥i tr∆∞·ªùng Ubuntu (WSL2):** M·ªü CMD ho·∫∑c PowerShell v√† g√µ l·ªánh:
<pre><code>wsl</code></pre>
    </li>
    <li>**Ki·ªÉm tra tr·∫°ng th√°i:** Sau khi v√†o terminal Ubuntu, ch·∫°y <code>jps</code> (ch·ªâ n√™n th·∫•y <code>Jps</code> v√† <code>bash</code>).</li>
    <li>**Kh·ªüi ƒë·ªông l·∫°i C·ª•m:** Ch·∫°y l·ªánh ƒë·ªÉ n·∫°p l·∫°i c·∫•u h√¨nh v√† kh·ªüi ƒë·ªông c√°c d·ªãch v·ª• HDFS/YARN:
<pre><code>start-all.sh</code></pre>
    </li>
    <li>**T·∫Øt To√†n b·ªô H·ªá th·ªëng (Khi D√πng Xong):**
        <ul>
            <li>**T·∫Øt Hadoop (Trong Ubuntu):** <code>stop-all.sh</code></li>
            <li>**T·∫Øt WSL2 (Trong CMD/PowerShell Windows):** <code>wsl --shutdown</code></li>
        </ul>
    </li>
</ol>

</body>
</html>